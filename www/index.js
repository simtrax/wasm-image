import { Image } from "image";
import { memory } from "image/image_bg";

const image = Image.new();
const width = image.width();
const height = image.height();

Image.parse_geometry('{"type":"MultiPolygon","coordinates":[[[[13.1920169408076,55.6811162980897,0],[13.1921801983454,55.6814031875439,0],[13.1925192637893,55.6821309007873,0],[13.1927872961453,55.6827025137286,0],[13.1930708477321,55.6826515078408,0],[13.1933863718305,55.6825846154896,0],[13.1963461294224,55.6818865961692,0],[13.1966038090823,55.6818310410182,0],[13.196675556375,55.6818197739223,0],[13.1968202495881,55.6818105939692,0],[13.1969659685282,55.6818150712271,0],[13.1971902346981,55.6818285027583,0],[13.197247746871,55.6818310370283,0],[13.1974911763963,55.6818435182398,0],[13.1988404831835,55.6819286164751,0],[13.2025565874969,55.6821428174513,0],[13.2027902611503,55.6821461222885,0],[13.2029773230978,55.6821231941741,0],[13.2030906061621,55.6820851030486,0],[13.2032948791353,55.682001107978,0],[13.2036795685782,55.681824319903,0],[13.2038585889991,55.6817272826452,0],[13.2039599972006,55.6816730290538,0],[13.2043586274449,55.6814577717379,0],[13.2045713068844,55.6813283423659,0],[13.2048811459556,55.6811588405819,0],[13.2056088294056,55.6807306538354,0],[13.2057075534266,55.680676898811,0],[13.2057339108361,55.6806348384313,0],[13.2057391699585,55.6805825120127,0],[13.2056821823249,55.680459832956,0],[13.205356479267,55.6799201548219,0],[13.2043443445916,55.6782405508457,0],[13.2042611723986,55.6781591068443,0],[13.2041867311454,55.6781182950437,0],[13.2041202222968,55.6781088111962,0],[13.2037144833241,55.6782106192037,0],[13.203506692496,55.6782743156022,0],[13.2033321073915,55.6783037359231,0],[13.20317857426,55.6782618286155,0],[13.2030398313433,55.6780950921822,0],[13.2028038657511,55.6777708633152,0],[13.2025580585108,55.6774386711058,0],[13.202371476814,55.6771121718452,0],[13.2022552150389,55.6769818196624,0],[13.2020588174519,55.6769047368972,0],[13.2019442727025,55.6768995719101,0],[13.2018409617387,55.6768974113012,0],[13.2017359963547,55.6769205608012,0],[13.2015623398777,55.6769603452371,0],[13.2014495739437,55.6769930053013,0],[13.2013513810976,55.6770314507876,0],[13.2011116575229,55.6770750295041,0],[13.20087104517,55.6771175162843,0],[13.2006076483123,55.6771439142943,0],[13.200510709695,55.6771570969854,0],[13.2002193954381,55.6771877491192,0],[13.1998976301982,55.6772269140286,0],[13.1995551101509,55.677284053266,0],[13.1993145761114,55.6773441527496,0],[13.1989728025977,55.6774158064002,0],[13.1987026004755,55.6774926076157,0],[13.1986521766301,55.6775069298417,0],[13.1982330401633,55.6776117944445,0],[13.1978121967836,55.6777419670208,0],[13.1974458610631,55.6778689215024,0],[13.197387159426,55.6778892597892,0],[13.1973008714969,55.6779201300982,0],[13.1962629605894,55.6783582054455,0],[13.1954982370382,55.6786531081771,0],[13.1951640292203,55.6788032025968,0],[13.1948317048419,55.6789541326572,0],[13.1946709313305,55.6790391399697,0],[13.1944066189396,55.6791333544903,0],[13.194008220827,55.6792424642378,0],[13.1935971354236,55.6793734941031,0],[13.1931744996301,55.6795579962279,0],[13.1928855525225,55.679718555683,0],[13.1928289899294,55.6797968987228,0],[13.1927557418845,55.6798983533789,0],[13.1925312934651,55.6801932743337,0],[13.1921197412897,55.68089395409,0],[13.1920169408076,55.6811162980897,0]]]]}')

const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');

canvas.width  = width;
canvas.height = height;

const pixelsPtr = image.pixels();
const pixels = new Uint8ClampedArray(memory.buffer, pixelsPtr, width * height * 4);

// console.log(pixels);

const imageData = new ImageData(pixels, width, height);

ctx.putImageData(imageData, 0, 0);